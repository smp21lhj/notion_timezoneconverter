<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>Timezone Converter Widget</title>
<script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>

<style>
:root {
  --bg: #ffffff;
  --text: #111;
  --sub: #666;
  --border: #ddd;
  --accent: #2563eb;
}
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #1e1e1e;
    --text: #f5f5f5;
    --sub: #aaa;
    --border: #333;
  }
}
body {
  margin: 0;
  padding: 14px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: var(--bg);
  color: var(--text);
}
.container {
  max-width: 480px;
}
input, select, button {
  width: 100%;
  padding: 10px;
  font-size: 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
}
.row {
  display: flex;
  gap: 6px;
}
.row input {
  text-align: center;
}
button.primary {
  background: var(--accent);
  color: #fff;
  border: none;
}
button.secondary {
  background: none;
}
.section {
  margin-top: 14px;
}
.result {
  border-top: 1px solid var(--border);
  padding-top: 10px;
  font-size: 14px;
}
.copy-buttons button {
  margin-top: 6px;
}
label {
  font-size: 13px;
}
.small {
  font-size: 12px;
  color: var(--sub);
}
</style>
</head>

<body>
<div class="container">
  <div class="section">
    <label>ì‹œê°„ ì…ë ¥</label>
    <div class="row">
      <input type="number" id="year" placeholder="YYYY" inputmode="numeric">
      <input type="number" id="month" placeholder="MM" inputmode="numeric">
      <input type="number" id="day" placeholder="DD" inputmode="numeric">
    </div>
    <div class="row">
      <input type="number" id="hour" placeholder="HH" inputmode="numeric">
      <input type="number" id="minute" placeholder="MM" inputmode="numeric">
    </div>
    <select id="baseZone"></select>
  </div>

  <div class="row">
    <button class="primary" onclick="convert()">ë³€í™˜</button>
    <button class="secondary" onclick="swapZone()">â†” ê¸°ì¤€ ì‹œê°„ëŒ€ ì „í™˜</button>
  </div>

  <div class="section">
    <label>ê²°ê³¼ ì‹œê°„ëŒ€ ì„ íƒ</label>
    <div id="zoneCheckboxes"></div>
  </div>

  <div class="section result" id="result"></div>

  <div class="section copy-buttons">
    <button onclick="copyISO()">ğŸ“‹ ISO ë³µì‚¬</button>
    <button onclick="copySlack()">ğŸ“‹ Slack ë³µì‚¬</button>
    <button onclick="copyGoogle()">ğŸ“‹ Google Calendar ë³µì‚¬</button>
  </div>
</div>

<script>
const { DateTime } = luxon;

const ZONES = [
  { id: "Asia/Seoul", label: "KST (í•œêµ­)", default: true },
  { id: "UTC", label: "UTC / GMT", default: true },
  { id: "America/New_York", label: "EST / EDT" },
  { id: "America/Los_Angeles", label: "PST / PDT" },
  { id: "Europe/London", label: "BST / GMT" },
  { id: "Europe/Paris", label: "CET" },
  { id: "Asia/Tokyo", label: "JST" },
  { id: "Asia/Shanghai", label: "CST (China)" },
  { id: "Australia/Sydney", label: "AEST" }
];

const baseSelect = document.getElementById("baseZone");
const checkboxWrap = document.getElementById("zoneCheckboxes");

ZONES.forEach(z => {
  const opt = document.createElement("option");
  opt.value = z.id;
  opt.textContent = z.label;
  baseSelect.appendChild(opt);

  const label = document.createElement("label");
  const cb = document.createElement("input");
  cb.type = "checkbox";
  cb.value = z.id;
  cb.checked = !!z.default;
  label.append(cb, " ", z.label);
  checkboxWrap.appendChild(label);
  checkboxWrap.appendChild(document.createElement("br"));
});

let lastBaseDateTime = null;

function convert() {
  const y = year.value, m = month.value, d = day.value;
  const h = hour.value || 0, min = minute.value || 0;
  const zone = baseSelect.value;

  lastBaseDateTime = DateTime.fromObject(
    { year: y, month: m, day: d, hour: h, minute: min },
    { zone }
  );

  const result = document.getElementById("result");
  result.innerHTML = "";

  document.querySelectorAll("#zoneCheckboxes input:checked").forEach(cb => {
    const dt = lastBaseDateTime.setZone(cb.value);
    result.innerHTML += `<div><strong>${cb.nextSibling.textContent}</strong><br>${dt.toFormat("yyyy-MM-dd HH:mm")}</div><br>`;
  });
}

function swapZone() {
  const selected = baseSelect.value;
  const checked = [...document.querySelectorAll("#zoneCheckboxes input:checked")];
  if (!checked.length) return;
  baseSelect.value = checked[0].value;
  checked[0].checked = false;
}

function copyISO() {
  if (!lastBaseDateTime) return;
  navigator.clipboard.writeText(lastBaseDateTime.toISO());
}

function copySlack() {
  if (!lastBaseDateTime) return;
  const ts = Math.floor(lastBaseDateTime.toSeconds());
  navigator.clipboard.writeText(`<!date^${ts}^{date_short} {time}|${lastBaseDateTime.toISO()}>`);
}

function copyGoogle() {
  if (!lastBaseDateTime) return;
  const start = lastBaseDateTime.toUTC().toFormat("yyyyMMdd'T'HHmmss'Z'");
  navigator.clipboard.writeText(start);
}
</script>
</body>
</html>
